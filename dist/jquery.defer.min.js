/*! Defer - v0.1.0 - 2013-01-29
* https://github.com/wheresrhys/jquery.defer
* Copyright (c) 2013 Rhys Evans; Licensed MIT */
(function(e){var t=function(e,t,n){this.obj=e,this.deferred=t,this.options=n,this.mode=n.mode,this.run()};t.prototype={run:function(){var t,n,i,s={},o=this.options,u=!!o&&!!o.applyToPrototype;this.mutator=this.mutators[this.mode];if(this.mode==="undefer"&&e.isFunction(this.obj))return this.obj;if(e.isFunction(this.obj))this.func=r(this.obj,this.deferred);else if(o&&o.methods){t=o.methods.split(" ");for(n=t.length-1;n>=0;n--)this.obj[t[n]]=this.mutator(t[n])}else{if(o&&o.exclude){t=o.exclude.split(" ");for(n=t.length-1;n>=0;n--)s[t[n]]=!0}for(i in this.obj){if(s[i])continue;(u||this.obj.hasOwnProperty(i))&&e.isFunction(this.obj[i])&&(this.obj[i]=this.mutator(i))}}return this.obj},mutators:{defer:function(e){return n(e,this.obj,this.deferred)},undefer:function(e){return this.obj[e]._originalFunction||this.obj[e]}}};var n=function(e,t,n){return r.call(t,t[e],n)},r=function(t,n){if(!e.isArray(n)){if(!n.promise)return t;n=[n]}var r=this,i=function(){var i=this!==window&&this,s=arguments;e.when.apply(null,n).done(function(){t.apply(i||r,s)})};return i._originalFunction=t,i};e.defer=function(n,r,i){i=e.extend(i||{},{mode:"defer"});var s=new t(n,r,i);return s.func||n},e.undefer=function(n,r){return r=e.extend(r||{},{mode:"undefer"}),new t(n,r.deferred||null,r),n}})(jQuery);